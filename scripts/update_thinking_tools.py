#!/usr/bin/env python3
"""æ›´æ–°é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ æ€ç»´é“¾æ§åˆ¶å·¥å…·"""

import json

# è¯»å–é…ç½®æ–‡ä»¶
with open('config/agent_llm_config.json', 'r', encoding='utf-8') as f:
    config = json.load(f)

# åœ¨ System Prompt ä¸­æ·»åŠ æ€ç»´é“¾å·¥å…·è¯´æ˜
sp = config.get('sp', '')

# æ£€æŸ¥æ˜¯å¦å·²ç»åŒ…å«æ€ç»´é“¾å·¥å…·è¯´æ˜
if 'æ€ç»´é“¾æ§åˆ¶å·¥å…·' not in sp:
    # åœ¨å®æ—¶è¯­éŸ³å¯¹è¯å·¥å…·ä¹‹åæ·»åŠ æ€ç»´é“¾æ§åˆ¶å·¥å…·è¯´æ˜
    if '### å®æ—¶è¯­éŸ³å¯¹è¯å·¥å…·ï¼ˆä¼˜åŒ–å»¶è¿Ÿï¼‰â­' in sp:
        new_section = """

### æ€ç»´é“¾æ§åˆ¶å·¥å…·ğŸ§ 
- `toggle_thinking_display`: åˆ‡æ¢æ€ç»´é“¾æ˜¾ç¤ºçŠ¶æ€ï¼ˆå¼€å¯/å…³é—­ï¼‰
- `get_thinking_status`: æŸ¥è¯¢å½“å‰æ€ç»´é“¾æ˜¾ç¤ºçŠ¶æ€

**åŠŸèƒ½è¯´æ˜ï¼š**
- å¼€å¯æ€ç»´é“¾æ˜¾ç¤ºï¼šåœ¨å›ç­”å‰å±•ç¤ºAIçš„æ€è€ƒè¿‡ç¨‹ï¼ŒåŒ…æ‹¬é—®é¢˜åˆ†æã€å·¥å…·é€‰æ‹©ç­‰æ­¥éª¤
- å…³é—­æ€ç»´é“¾æ˜¾ç¤ºï¼šç›´æ¥ç»™å‡ºæœ€ç»ˆç­”æ¡ˆï¼Œé€‚åˆå¿«é€Ÿé—®ç­”åœºæ™¯
- ç”¨æˆ·å¯ä»¥éšæ—¶è°ƒç”¨å·¥å…·åˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€ï¼Œæ— éœ€ä¿®æ”¹é…ç½®æ–‡ä»¶

**ä½¿ç”¨åœºæ™¯ï¼š**
- æ•™å­¦åœºæ™¯ï¼šå»ºè®®å¼€å¯ï¼Œå¸®åŠ©å­¦ç”Ÿç†è§£AIçš„åˆ†ææ€è·¯
- å¿«é€Ÿé—®ç­”ï¼šå»ºè®®å…³é—­ï¼Œç›´æ¥è·å–ç­”æ¡ˆ
- é—®é¢˜æ’æŸ¥ï¼šå»ºè®®å¼€å¯ï¼Œä¾¿äºç†è§£AIçš„å¤„ç†é€»è¾‘

"""
        # æ’å…¥åˆ°å·¥å…·åˆ—è¡¨ä¸­
        sp = sp.replace(
            '### å®æ—¶è¯­éŸ³å¯¹è¯å·¥å…·ï¼ˆä¼˜åŒ–å»¶è¿Ÿï¼‰â­\n',
            '### å®æ—¶è¯­éŸ³å¯¹è¯å·¥å…·ï¼ˆä¼˜åŒ–å»¶è¿Ÿï¼‰â­\n' + new_section
        )
        
        config['sp'] = sp

# åœ¨å·¥å…·åˆ—è¡¨ä¸­æ·»åŠ æ€ç»´é“¾æ§åˆ¶å·¥å…·
tools = config.get('tools', [])
new_tools = ['toggle_thinking_display', 'get_thinking_status']

for new_tool in new_tools:
    if new_tool not in tools:
        tools.append(new_tool)

config['tools'] = tools

# ä¿å­˜é…ç½®æ–‡ä»¶
with open('config/agent_llm_config.json', 'w', encoding='utf-8') as f:
    json.dump(config, f, ensure_ascii=False, indent=4)

print("âœ… æ€ç»´é“¾æ§åˆ¶å·¥å…·å·²æ·»åŠ åˆ°é…ç½®æ–‡ä»¶")
print(f"   æ–°å¢å·¥å…·ï¼š{new_tools}")
print(f"   æ€»å·¥å…·æ•°ï¼š{len(tools)}")
